# üèóÔ∏è –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê –ë–ê–ì–ê–¢–û–ö–û–†–ò–°–¢–£–í–ê–¶–¨–ö–û–á –°–ò–°–¢–ï–ú–ò

> **–ê–Ω–∞–ª—ñ–∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–ª—è –±–∞–≥–∞—Ç–æ–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ Upwork Web App –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é –±–µ–∑–ø–µ–∫–æ—é**

---

## üéØ **–ü–†–û–ë–õ–ï–ú–ê**

–ù–∞—à –¥–æ–¥–∞—Ç–æ–∫ –º–∞—î –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ **–±–∞–≥–∞—Ç–æ —Ñ—Ä—ñ–ª–∞–Ω—Å–µ—Ä—ñ–≤**, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö:
- –ú–∞—î —Å–≤—ñ–π Upwork –∞–∫–∞—É–Ω—Ç
- –ü–æ—Ç—Ä–µ–±—É—î —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ API
- –ú–∞—î –≤–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ (–≤–∞–∫–∞–Ω—Å—ñ—ó, –≤—ñ–¥–≥—É–∫–∏, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è)
- –ü–æ—Ç—Ä–µ–±—É—î —ñ–∑–æ–ª—è—Ü—ñ—é –¥–∞–Ω–∏—Ö –≤—ñ–¥ —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–ú–æ–∂–µ –±—É—Ç–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–º —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**
- **–ü–æ—Ç—Ä–µ–±—É—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –±–µ–∑–ø–µ–∫—É**

---

## üîç **–ê–ù–ê–õ–Ü–ó UPWORK API –û–ë–ú–ï–ñ–ï–ù–¨**

### **OAuth 2.0 Flow –¥–ª—è Upwork:**
1. **Application Registration** - —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –¥–æ–¥–∞—Ç–∫—É –≤ Upwork
2. **User Authorization** - –∫–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç—å—Å—è
3. **Access Token** - —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∏–π —Ç–æ–∫–µ–Ω –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
4. **API Calls** - –≤–∏–∫–ª–∏–∫–∏ –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### **–û–±–º–µ–∂–µ–Ω–Ω—è:**
- ‚ùå **–ù–µ–º–∞—î Application-level API** - —Ç—ñ–ª—å–∫–∏ User-level
- ‚ùå **–ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Å–≤—ñ–π —Ç–æ–∫–µ–Ω** - –Ω–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–¥–∏–Ω –¥–ª—è –≤—Å—ñ—Ö
- ‚ùå **Rate limits per user** - –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚ùå **Token expiration** - —Ç–æ–∫–µ–Ω–∏ –º–∞—é—Ç—å —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó

---

## üèóÔ∏è **–í–ê–†–Ü–ê–ù–¢–ò –ê–†–•–Ü–¢–ï–ö–¢–£–†–ò**

### **–í–ê–†–Ü–ê–ù–¢ 1: –Ü–ù–î–ò–í–Ü–î–£–ê–õ–¨–ù–Ü API –ö–õ–Æ–ß–Ü + –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê –ë–ï–ó–ü–ï–ö–ê**

#### **–ü—Ä–∏–Ω—Ü–∏–ø:**
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Üí –°–≤–æ—ó API –∫–ª—é—á—ñ ‚Üí –ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ Upwork API
+ –ü–æ–≤–Ω–∞ —ñ–∑–æ–ª—è—Ü—ñ—è –¥–∞–Ω–∏—Ö + MFA + –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è + –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
```

#### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```python
# –ú–æ–¥–µ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é –±–µ–∑–ø–µ–∫–æ—é
class User(Base):
    id = Column(Integer, primary_key=True)
    email = Column(String, unique=True)
    password_hash = Column(String)  # bcrypt
    upwork_access_token = Column(String, encrypted=True)
    upwork_refresh_token = Column(String, encrypted=True)
    upwork_user_id = Column(String)
    role = Column(String, default='freelancer')
    is_verified = Column(Boolean, default=False)
    mfa_enabled = Column(Boolean, default=False)
    failed_login_attempts = Column(Integer, default=0)
    account_locked_until = Column(DateTime)
    
    # –í–ª–∞—Å–Ω—ñ –¥–∞–Ω—ñ
    jobs = relationship("Job", back_populates="user")
    applications = relationship("Application", back_populates="user")
    messages = relationship("Message", back_populates="user")
    security_logs = relationship("SecurityLog", back_populates="user")
```

#### **–ü–µ—Ä–µ–≤–∞–≥–∏:**
- ‚úÖ **–ü–æ–≤–Ω–∞ —ñ–∑–æ–ª—è—Ü—ñ—è** - –∫–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Å–≤–æ—ó –¥–∞–Ω—ñ
- ‚úÖ **–õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å** - –∫–æ–∂–µ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–≤–æ—ó credentials
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å** - –Ω–µ–º–∞—î –æ–±–º–µ–∂–µ–Ω—å –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –±–µ–∑–ø–µ–∫–∞** - MFA, —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ **–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤** - –ø–æ–≤–Ω–∞ —ñ–∑–æ–ª—è—Ü—ñ—è –¥–∞–Ω–∏—Ö
- ‚úÖ **GDPR compliance** - –ø–æ–≤–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å

#### **–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚ùå **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è** - –∫–æ–∂–µ–Ω –º–∞—î –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ API
- ‚ùå **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞–º–∏** - –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ expired —Ç–æ–∫–µ–Ω–∏
- ‚ùå **–¢–µ—Ö–Ω—ñ—á–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å** - OAuth flow –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚ùå **–í–∏—Å–æ–∫–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å —Ä–æ–∑—Ä–æ–±–∫–∏** - —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –±–µ–∑–ø–µ–∫–∏

---

### **–í–ê–†–Ü–ê–ù–¢ 2: –¶–ï–ù–¢–†–ê–õ–Ü–ó–û–í–ê–ù–ê –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê**

#### **–ü—Ä–∏–Ω—Ü–∏–ø:**
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Üí –ù–∞—à —Å–µ—Ä–≤–µ—Ä ‚Üí Upwork API (—á–µ—Ä–µ–∑ –Ω–∞—à—ñ credentials)
```

#### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```python
# –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
class SystemConfig(Base):
    id = Column(Integer, primary_key=True)
    upwork_api_key = Column(String)
    upwork_api_secret = Column(String)
    upwork_access_token = Column(String)
    
# –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –±–µ–∑ API –∫–ª—é—á—ñ–≤
class User(Base):
    id = Column(Integer, primary_key=True)
    email = Column(String, unique=True)
    upwork_user_id = Column(String)  # ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ Upwork
    # –ù–µ–º–∞—î –≤–ª–∞—Å–Ω–∏—Ö API –∫–ª—é—á—ñ–≤
```

#### **–ü–µ—Ä–µ–≤–∞–≥–∏:**
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** - –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ API
- ‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è** - –æ–¥–∏–Ω –Ω–∞–±—ñ—Ä credentials
- ‚úÖ **–õ–µ–≥—à–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è** - –º–µ–Ω—à–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

#### **–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚ùå **–ü–æ—Ä—É—à–µ–Ω–Ω—è ToS** - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á—É–∂–∏—Ö credentials
- ‚ùå **–û–±–º–µ–∂–µ–Ω–Ω—è –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** - rate limits –Ω–∞ –æ–¥–∏–Ω –∞–∫–∞—É–Ω—Ç
- ‚ùå **–ü—Ä–∞–≤–æ–≤—ñ —Ä–∏–∑–∏–∫–∏** - –º–æ–∂–ª–∏–≤—ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
- ‚ùå **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —ñ–∑–æ–ª—è—Ü—ñ—ó** - –≤—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –æ–¥–∏–Ω –∞–∫–∞—É–Ω—Ç
- ‚ùå **–†–∏–∑–∏–∫ –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤** - –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ—Ö—Ä–µ—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É

---

### **–í–ê–†–Ü–ê–ù–¢ 3: –ì–Ü–ë–†–ò–î–ù–ê –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê**

#### **–ü—Ä–∏–Ω—Ü–∏–ø:**
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á ‚Üí –í–∏–±—ñ—Ä: –°–≤–æ—ó API –∫–ª—é—á—ñ –ê–ë–û –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø
```

#### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
```python
class User(Base):
    id = Column(Integer, primary_key=True)
    email = Column(String, unique=True)
    auth_type = Column(String)  # "personal" –∞–±–æ "centralized"
    
    # –î–ª—è –æ—Å–æ–±–∏—Å—Ç–∏—Ö –∫–ª—é—á—ñ–≤
    upwork_access_token = Column(String, encrypted=True, nullable=True)
    upwork_refresh_token = Column(String, encrypted=True, nullable=True)
    
    # –î–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É
    upwork_user_id = Column(String, nullable=True)
```

#### **–ü–µ—Ä–µ–≤–∞–≥–∏:**
- ‚úÖ **–ì–Ω—É—á–∫—ñ—Å—Ç—å** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –≤–∏–±–∏—Ä–∞—é—Ç—å –ø—ñ–¥—Ö—ñ–¥
- ‚úÖ **–ü–æ—Å—Ç—É–ø–æ–≤–µ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è** - –º–æ–∂–Ω–∞ –ø–æ—á–∞—Ç–∏ –∑ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è** - –æ—Å–æ–±–∏—Å—Ç—ñ –∫–ª—é—á—ñ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

#### **–ù–µ–¥–æ–ª—ñ–∫–∏:**
- ‚ùå **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó** - –¥–≤–∞ –ø—ñ–¥—Ö–æ–¥–∏ –≤ –æ–¥–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ
- ‚ùå **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –ø—ñ–¥—Ç—Ä–∏–º–∫–∏** - —Ä—ñ–∑–Ω—ñ –ª–æ–≥—ñ–∫–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤
- ‚ùå **–ü–ª—É—Ç–∞–Ω–∏–Ω–∞** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å –Ω–µ —Ä–æ–∑—É–º—ñ—Ç–∏ —Ä—ñ–∑–Ω–∏—Ü—ñ
- ‚ùå **–†–∏–∑–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏** - –∑–º—ñ—à–∞–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏

---

## üéØ **–†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–ò–ô –í–ê–†–Ü–ê–ù–¢: –í–ê–†–Ü–ê–ù–¢ 1**

### **–ß–æ–º—É —Å–∞–º–µ —Ü–µ–π –≤–∞—Ä—ñ–∞–Ω—Ç:**

#### **1. –õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –±–µ–∑–ø–µ–∫–∞**
- ‚úÖ –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–≤–æ—ó credentials
- ‚úÖ –ù–µ–º–∞—î –ø–æ—Ä—É—à–µ–Ω—å Terms of Service
- ‚úÖ –ü–æ–≤–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å Upwork API guidelines
- ‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –±–µ–∑–ø–µ–∫–∞ –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤**

#### **2. –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å**
- ‚úÖ –ù–µ–º–∞—î –æ–±–º–µ–∂–µ–Ω—å –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ Rate limits —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –º—ñ–∂ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏
- ‚úÖ –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Å–≤–æ—ó –æ–±–º–µ–∂–µ–Ω–Ω—è

#### **3. –Ü–∑–æ–ª—è—Ü—ñ—è –¥–∞–Ω–∏—Ö**
- ‚úÖ –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Å–≤–æ—ó –¥–∞–Ω—ñ
- ‚úÖ –ù–µ–º–∞—î —Ä–∏–∑–∏–∫—ñ–≤ –ø–µ—Ä–µ—Ö—Ä–µ—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É
- ‚úÖ GDPR compliance
- ‚úÖ **–ü–æ–≤–Ω–∞ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤**

#### **4. –î–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–∞ —Å—Ç—ñ–π–∫—ñ—Å—Ç—å**
- ‚úÖ –ù–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É
- ‚úÖ –†–∏–∑–∏–∫ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π
- ‚úÖ –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É

---

## üîê **–°–ò–°–¢–ï–ú–ê –ë–ï–ó–ü–ï–ö–ò**

### **1. –ú–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (MFA)**

#### **TOTP (Time-based One-Time Password):**
```python
import pyotp

class MFAManager:
    def generate_secret(self):
        return pyotp.random_base32()
    
    def verify_totp(self, secret, token):
        totp = pyotp.TOTP(secret)
        return totp.verify(token)
    
    def generate_qr_code(self, secret, email):
        return pyotp.totp.TOTP(secret).provisioning_uri(
            email, issuer_name="Upwork Web App"
        )
```

#### **Backup –∫–æ–¥–∏:**
```python
def generate_backup_codes(self, count=10):
    codes = []
    for _ in range(count):
        code = secrets.token_hex(4).upper()[:8]
        codes.append(code)
    return codes
```

### **2. –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤**

#### **EncryptionManager:**
```python
from cryptography.fernet import Fernet

class EncryptionManager:
    def __init__(self, key):
        self.cipher = Fernet(key)
    
    def encrypt_token(self, token):
        return self.cipher.encrypt(token.encode()).decode()
    
    def decrypt_token(self, encrypted_token):
        return self.cipher.decrypt(encrypted_token.encode()).decode()
```

### **3. JWT —Ç–æ–∫–µ–Ω–∏**

#### **JWTManager:**
```python
class JWTManager:
    def create_access_token(self, data: dict):
        to_encode = data.copy()
        expire = datetime.utcnow() + timedelta(minutes=30)
        to_encode.update({"exp": expire})
        encoded_jwt = jwt.encode(to_encode, self.secret_key, algorithm=self.algorithm)
        return encoded_jwt
    
    def create_refresh_token(self, data: dict):
        to_encode = data.copy()
        expire = datetime.utcnow() + timedelta(days=7)
        to_encode.update({"exp": expire, "type": "refresh"})
        encoded_jwt = jwt.encode(to_encode, self.secret_key, algorithm=self.algorithm)
        return encoded_jwt
```

### **4. Rate Limiting**

#### **RateLimiter:**
```python
class RateLimiter:
    def check_rate_limit(self, user_id, action, limit, window):
        key = f"rate_limit:{user_id}:{action}"
        current = self.redis_client.incr(key)
        if current == 1:
            self.redis_client.expire(key, window)
        return current <= limit
```

### **5. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–ø–µ–∫–∏**

#### **SecurityMonitor:**
```python
class SecurityMonitor:
    async def log_security_event(self, user_id, action, ip_address, user_agent, success, details=None):
        log_entry = SecurityLog(
            user_id=user_id,
            action=action,
            ip_address=ip_address,
            user_agent=user_agent,
            success=success,
            details=details
        )
        # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –ë–î
    
    async def create_security_alert(self, user_id, alert_type, severity, description, details=None):
        alert = SecurityAlert(
            user_id=user_id,
            alert_type=alert_type,
            severity=severity,
            description=description,
            details=details
        )
        # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
```

---

## üèóÔ∏è **–î–ï–¢–ê–õ–¨–ù–ê –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê**

### **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö:**

```sql
-- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é –±–µ–∑–ø–µ–∫–æ—é
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    upwork_access_token TEXT,  -- –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π
    upwork_refresh_token TEXT, -- –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π
    upwork_user_id VARCHAR(255),
    token_expires_at TIMESTAMP,
    role VARCHAR(50) DEFAULT 'freelancer',
    is_verified BOOLEAN DEFAULT false,
    is_active BOOLEAN DEFAULT true,
    email_verified BOOLEAN DEFAULT false,
    phone_verified BOOLEAN DEFAULT false,
    last_login TIMESTAMP,
    failed_login_attempts INTEGER DEFAULT 0,
    account_locked_until TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- –ë–µ–∑–ø–µ–∫–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (MFA)
CREATE TABLE user_security (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    mfa_enabled BOOLEAN DEFAULT false,
    mfa_secret VARCHAR(255), -- –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π
    backup_codes JSON, -- –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π
    phone_number VARCHAR(20),
    phone_verified BOOLEAN DEFAULT false,
    session_timeout INTEGER DEFAULT 3600,
    max_concurrent_sessions INTEGER DEFAULT 5
);

-- –†–æ–ª—ñ —Ç–∞ –¥–æ–∑–≤–æ–ª–∏
CREATE TABLE roles (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50) UNIQUE NOT NULL,
    description VARCHAR(255),
    permissions JSON NOT NULL,
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE TABLE user_roles (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    role_id INTEGER REFERENCES roles(id),
    granted_by INTEGER REFERENCES users(id),
    granted_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP
);

-- –õ–æ–≥–∏ –±–µ–∑–ø–µ–∫–∏
CREATE TABLE security_logs (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    action VARCHAR(100) NOT NULL,
    ip_address VARCHAR(45),
    user_agent VARCHAR(500),
    success BOOLEAN DEFAULT true,
    details JSON,
    created_at TIMESTAMP DEFAULT NOW(),
    session_id VARCHAR(255)
);

-- –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏
CREATE TABLE security_alerts (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    alert_type VARCHAR(100) NOT NULL,
    severity VARCHAR(20) NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    details JSON,
    resolved BOOLEAN DEFAULT false,
    resolved_by INTEGER REFERENCES users(id),
    resolved_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –í–∞–∫–∞–Ω—Å—ñ—ó (–∑ –ø—Ä–∏–≤'—è–∑–∫–æ—é –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞)
CREATE TABLE jobs (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    upwork_job_id VARCHAR(255) NOT NULL,
    title VARCHAR(500) NOT NULL,
    description TEXT,
    budget_min DECIMAL(10,2),
    budget_max DECIMAL(10,2),
    hourly_rate_min DECIMAL(10,2),
    hourly_rate_max DECIMAL(10,2),
    skills TEXT[],
    category VARCHAR(255),
    client_location VARCHAR(255),
    client_feedback DECIMAL(3,2),
    job_type VARCHAR(50),
    created_at TIMESTAMP DEFAULT NOW()
);

-- –í—ñ–¥–≥—É–∫–∏ (–∑ –ø—Ä–∏–≤'—è–∑–∫–æ—é –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞)
CREATE TABLE applications (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    job_id INTEGER REFERENCES jobs(id),
    upwork_job_id VARCHAR(255) NOT NULL,
    proposal_text TEXT NOT NULL,
    cover_letter TEXT,
    bid_amount DECIMAL(10,2),
    estimated_hours INTEGER,
    status VARCHAR(50) DEFAULT 'draft',
    ai_generated BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### **API Endpoints:**

```python
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
POST /auth/register
POST /auth/login
POST /auth/mfa/verify
POST /auth/upwork/connect
POST /auth/upwork/callback
POST /auth/refresh
POST /auth/logout

# –ë–µ–∑–ø–µ–∫–∞
GET  /security/profile
POST /security/mfa/enable
POST /security/mfa/disable
POST /security/password
GET  /security/logs
POST /security/verify

# –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
GET /users/profile
PUT /users/profile
GET /users/upwork/status

# –í–∞–∫–∞–Ω—Å—ñ—ó (–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é –ø–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É)
GET /jobs
GET /jobs/{job_id}
POST /jobs/search

# –í—ñ–¥–≥—É–∫–∏ (–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é –ø–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É)
GET /applications
POST /applications
PUT /applications/{application_id}

# –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è (—Ç—ñ–ª—å–∫–∏ –∞–¥–º—ñ–Ω–∏)
GET  /admin/users
GET  /admin/alerts
POST /admin/users/{id}/lock
```

### **OAuth Flow:**

```python
# 1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞—Ç–∏—Å–∫–∞—î "–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ Upwork"
GET /auth/upwork/connect
# ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ Upwork OAuth

# 2. Upwork –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞–∑–∞–¥ –∑ –∫–æ–¥–æ–º
POST /auth/upwork/callback?code=xxx&state=yyy
# ‚Üí –û–±–º—ñ–Ω –∫–æ–¥—É –Ω–∞ —Ç–æ–∫–µ–Ω–∏
# ‚Üí –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤
# ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –¥–æ–¥–∞—Ç–æ–∫

# 3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –¥–ª—è API –≤–∏–∫–ª–∏–∫—ñ–≤
GET /jobs
# ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
```

---

## üìã **–ü–õ–ê–ù –í–ü–†–û–í–ê–î–ñ–ï–ù–ù–Ø**

### **–ï—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞ –±–µ–∑–ø–µ–∫–∞ (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ –≤—Ö—ñ–¥**
   - –í–∞–ª—ñ–¥–∞—Ü—ñ—è email/–ø–∞—Ä–æ–ª—è
   - bcrypt —Ö–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
   - Rate limiting –¥–ª—è –≤—Ö–æ–¥—É
   - –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—ñ—Å–ª—è –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±

2. **JWT —Ç–æ–∫–µ–Ω–∏**
   - Access —Ç–∞ refresh —Ç–æ–∫–µ–Ω–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
   - Blacklist –¥–ª—è logout

### **–ï—Ç–∞–ø 2: OAuth 2.0 (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **Upwork —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è**
   - OAuth flow
   - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

2. **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è**
   - –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –≤ –ë–î
   - –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è

### **–ï—Ç–∞–ø 3: –†–æ–∑—à–∏—Ä–µ–Ω–∞ –±–µ–∑–ø–µ–∫–∞ (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **MFA**
   - TOTP (Google Authenticator)
   - SMS –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è
   - Backup –∫–æ–¥–∏

2. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**
   - –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –¥—ñ–π
   - –°–∏—Å—Ç–µ–º–∞ —Å–ø–æ–≤—ñ—â–µ–Ω—å
   - –ê–Ω–∞–ª—ñ–∑ –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### **–ï—Ç–∞–ø 4: –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π**
   - –†—ñ–∑–Ω—ñ —Ä—ñ–≤–Ω—ñ –¥–æ—Å—Ç—É–ø—É
   - –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å

2. **–ê—É–¥–∏—Ç**
   - –î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏
   - –ï–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö
   - –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏

---

## ‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–Ü –ó–ê–£–í–ê–ñ–ï–ù–ù–Ø**

### **–ë–µ–∑–ø–µ–∫–∞:**
- üîê **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤** - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ
- üîê **HTTPS** - –¥–ª—è –≤—Å—ñ—Ö API –≤–∏–∫–ª–∏–∫—ñ–≤
- üîê **–í–∞–ª—ñ–¥–∞—Ü—ñ—è** - –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- üîê **Rate limiting** - –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –∑–ª–æ–≤–∂–∏–≤–∞–Ω—å

### **–õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å:**
- ‚úÖ **Terms of Service** - –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è Upwork ToS
- ‚úÖ **OAuth 2.0** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π flow
- ‚úÖ **User consent** - –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∑–≥–æ–¥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ **Data privacy** - –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è GDPR

### **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:**
- üìà **Rate limits** - –∫–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Å–≤–æ—ó –æ–±–º–µ–∂–µ–Ω–Ω—è
- üìà **Database indexing** - —ñ–Ω–¥–µ–∫—Å–∏ –Ω–∞ `user_id`
- üìà **Caching** - –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è API –≤–∏–∫–ª–∏–∫—ñ–≤
- üìà **Monitoring** - –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API

### **–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤:**
- üîí **–ü–æ–≤–Ω–∞ —ñ–∑–æ–ª—è—Ü—ñ—è –¥–∞–Ω–∏—Ö** - –∫–æ–∂–µ–Ω –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ —Å–≤–æ—ó –¥–∞–Ω—ñ
- üîí **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è** - –≤—Å—ñ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ
- üîí **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥** - –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- üîí **–ê—É–¥–∏—Ç** - –¥–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏ –≤—Å—ñ—Ö –¥—ñ–π

---

## üöÄ **–ù–ê–°–¢–£–ü–ù–Ü –ö–†–û–ö–ò**

1. **–ó–∞—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É** - –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –í–∞—Ä—ñ–∞–Ω—Ç 1
2. **–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –≤ Upwork** - —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫
3. **–ü–æ—á–∞—Ç–∏ –∑ –ï—Ç–∞–ø—É 1** - –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏
4. **–Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –≤ project_plan.md** - –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –µ—Ç–∞–ø–∏
5. **–û–Ω–æ–≤–∏—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é** - –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –∑–º—ñ–Ω–∏

---

*–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: 2024-12-19* 