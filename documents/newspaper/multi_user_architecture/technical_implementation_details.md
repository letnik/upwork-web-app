# üîß –¢–ï–•–ù–Ü–ß–ù–Ü –î–ï–¢–ê–õ–Ü –†–ï–ê–õ–Ü–ó–ê–¶–Ü–á

> **–î–µ—Ç–∞–ª—å–Ω–∏–π –ø–ª–∞–Ω —Ç–µ—Ö–Ω—ñ—á–Ω–æ—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –±–∞–≥–∞—Ç–æ–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ—ó —Å–∏—Å—Ç–µ–º–∏ –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—é –±–µ–∑–ø–µ–∫–æ—é**

---

## üèóÔ∏è **–û–ù–û–í–õ–ï–ù–ù–Ø –ê–†–•–Ü–¢–ï–ö–¢–£–†–ò –ü–†–û–ï–ö–¢–£**

### **–ü–æ—Ç–æ—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Üí –ù–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
upwork_web_app/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ auth/                    # –ù–û–í–ê –ü–ê–ü–ö–ê - –°–ò–°–¢–ï–ú–ê –ë–ï–ó–ü–ï–ö–ò
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py            # User, UserSecurity, Role –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ oauth.py            # OAuth 2.0 –ª–æ–≥—ñ–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mfa.py              # –ú–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jwt_manager.py      # JWT —Ç–æ–∫–µ–Ω–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ encryption.py       # –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware.py       # Auth middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rate_limiter.py     # Rate limiting
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security_monitor.py # –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–ø–µ–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.py            # Auth utilities
‚îÇ   ‚îú‚îÄ‚îÄ api/                     # –ù–û–í–ê –ü–ê–ü–ö–ê
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ v1/                 # API –≤–µ—Ä—Å—ñ—è 1
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py         # Auth endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security.py     # Security endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py        # User endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ jobs.py         # Jobs endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ applications.py # Applications endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ messages.py     # Messages endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py     # API dependencies
‚îÇ   ‚îú‚îÄ‚îÄ services/                # –ù–û–í–ê –ü–ê–ü–ö–ê
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ upwork_service.py   # Upwork API service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai_service.py       # AI service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security_service.py # Security service
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notification_service.py
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ token_manager.py    # –ù–û–í–ò–ô –§–ê–ô–õ
‚îÇ       ‚îú‚îÄ‚îÄ encryption.py       # –ù–û–í–ò–ô –§–ê–ô–õ
‚îÇ       ‚îî‚îÄ‚îÄ security_logger.py  # –ù–û–í–ò–ô –§–ê–ô–õ
```

---

## üîê **–°–ò–°–¢–ï–ú–ê –ë–ï–ó–ü–ï–ö–ò**

### **1. –ú–æ–¥–µ–ª—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö**

#### **User –º–æ–¥–µ–ª—å:**
```python
from sqlalchemy import Column, Integer, String, Boolean, DateTime, ForeignKey
from sqlalchemy.orm import relationship
from sqlalchemy.ext.declarative import declarative_base
from datetime import datetime

Base = declarative_base()

class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True)
    email = Column(String(255), unique=True, nullable=False)
    password_hash = Column(String(255), nullable=False)  # bcrypt
    first_name = Column(String(100))
    last_name = Column(String(100))
    
    # Upwork credentials (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ)
    upwork_access_token = Column(String(1000), nullable=True)
    upwork_refresh_token = Column(String(1000), nullable=True)
    upwork_user_id = Column(String(255), nullable=True)
    token_expires_at = Column(DateTime, nullable=True)
    
    # –ë–µ–∑–ø–µ–∫–∞
    role = Column(String(50), default='freelancer')  # freelancer, premium, admin, moderator
    is_verified = Column(Boolean, default=False)
    is_active = Column(Boolean, default=True)
    email_verified = Column(Boolean, default=False)
    phone_verified = Column(Boolean, default=False)
    
    # –õ–æ–≥—É–≤–∞–Ω–Ω—è
    last_login = Column(DateTime, nullable=True)
    failed_login_attempts = Column(Integer, default=0)
    account_locked_until = Column(DateTime, nullable=True)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    
    # –í—ñ–¥–Ω–æ—Å–∏–Ω–∏
    security = relationship("UserSecurity", back_populates="user", uselist=False)
    roles = relationship("UserRole", back_populates="user")
    security_logs = relationship("SecurityLog", back_populates="user")
    alerts = relationship("SecurityAlert", back_populates="user")
```

#### **UserSecurity –º–æ–¥–µ–ª—å (MFA):**
```python
class UserSecurity(Base):
    __tablename__ = "user_security"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    
    # MFA –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    mfa_enabled = Column(Boolean, default=False)
    mfa_secret = Column(String(255), nullable=True)  # TOTP secret (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π)
    backup_codes = Column(JSON, nullable=True)  # Backup –∫–æ–¥–∏ (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ)
        
    # –î–æ–¥–∞—Ç–∫–æ–≤–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è
    phone_number = Column(String(20), nullable=True)
    phone_verified = Column(Boolean, default=False)
    
    # –ë–µ–∑–ø–µ–∫–∞ —Å–µ—Å—ñ–π
    session_timeout = Column(Integer, default=3600)  # –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    max_concurrent_sessions = Column(Integer, default=5)
    
    # –í—ñ–¥–Ω–æ—Å–∏–Ω–∏
    user = relationship("User", back_populates="security")
```

#### **Role –º–æ–¥–µ–ª—å (—Å–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π):**
```python
class Role(Base):
    __tablename__ = "roles"
    
    id = Column(Integer, primary_key=True)
    name = Column(String(50), unique=True, nullable=False)
    description = Column(String(255))
    permissions = Column(JSON, nullable=False)  # –°–ø–∏—Å–æ–∫ –¥–æ–∑–≤–æ–ª—ñ–≤
    is_active = Column(Boolean, default=True)
    created_at = Column(DateTime, default=datetime.utcnow)

class UserRole(Base):
    __tablename__ = "user_roles"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    role_id = Column(Integer, ForeignKey("roles.id"), nullable=False)
    granted_by = Column(Integer, ForeignKey("users.id"), nullable=True)
    granted_at = Column(DateTime, default=datetime.utcnow)
    expires_at = Column(DateTime, nullable=True)
    
    # –í—ñ–¥–Ω–æ—Å–∏–Ω–∏
    user = relationship("User", back_populates="roles")
    role = relationship("Role")
```

#### **SecurityLog –º–æ–¥–µ–ª—å (–ª–æ–≥—ñ –±–µ–∑–ø–µ–∫–∏):**
```python
class SecurityLog(Base):
    __tablename__ = "security_logs"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=True)
    
    # –î–µ—Ç–∞–ª—ñ –ø–æ–¥—ñ—ó
    action = Column(String(100), nullable=False)  # login, logout, api_call, data_access
    ip_address = Column(String(45), nullable=True)  # IPv4/IPv6
    user_agent = Column(String(500), nullable=True)
    success = Column(Boolean, default=True)
    details = Column(JSON, nullable=True)
    
    # –ú–µ—Ç–∞–¥–∞–Ω—ñ
    created_at = Column(DateTime, default=datetime.utcnow)
    session_id = Column(String(255), nullable=True)
```

#### **SecurityAlert –º–æ–¥–µ–ª—å (—Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏):**
```python
class SecurityAlert(Base):
    __tablename__ = "security_alerts"
    
    id = Column(Integer, primary_key=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=True)
    
    # –î–µ—Ç–∞–ª—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
    alert_type = Column(String(100), nullable=False)  # suspicious_activity, failed_login, data_breach
    severity = Column(String(20), nullable=False)  # low, medium, high, critical
    title = Column(String(255), nullable=False)
    description = Column(Text, nullable=True)
    details = Column(JSON, nullable=True)
    
    # –°—Ç–∞—Ç—É—Å
    resolved = Column(Boolean, default=False)
    resolved_by = Column(Integer, ForeignKey("users.id"), nullable=True)
    resolved_at = Column(DateTime, nullable=True)
    
    # –ú–µ—Ç–∞–¥–∞–Ω—ñ
    created_at = Column(DateTime, default=datetime.utcnow)
    
    # –í—ñ–¥–Ω–æ—Å–∏–Ω–∏
    user = relationship("User", back_populates="alerts")
```

### **2. –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö**

#### **EncryptionManager:**
```python
from cryptography.fernet import Fernet
import base64
import os
from typing import Optional

class EncryptionManager:
    def __init__(self):
        key = os.getenv('ENCRYPTION_KEY')
        if not key:
            raise ValueError("ENCRYPTION_KEY environment variable is required")
        
        # –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ base64 –∫–ª—é—á –≤ bytes
        self.key = base64.urlsafe_b64encode(key.encode())
        self.cipher = Fernet(self.key)
    
    def encrypt(self, data: str) -> str:
        """–®–∏—Ñ—Ä—É—î –¥–∞–Ω—ñ"""
        if not data:
            return data
        encrypted_bytes = self.cipher.encrypt(data.encode())
        return base64.urlsafe_b64encode(encrypted_bytes).decode()
    
    def decrypt(self, encrypted_data: str) -> str:
        """–†–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î –¥–∞–Ω—ñ"""
        if not encrypted_data:
            return encrypted_data
        encrypted_bytes = base64.urlsafe_b64decode(encrypted_data.encode())
        decrypted_bytes = self.cipher.decrypt(encrypted_bytes)
        return decrypted_bytes.decode()
    
    def encrypt_json(self, data: dict) -> str:
        """–®–∏—Ñ—Ä—É—î JSON –¥–∞–Ω—ñ"""
        import json
        json_str = json.dumps(data)
        return self.encrypt(json_str)
    
    def decrypt_json(self, encrypted_data: str) -> dict:
        """–†–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î JSON –¥–∞–Ω—ñ"""
        import json
        decrypted_str = self.decrypt(encrypted_data)
        return json.loads(decrypted_str)
```

### **3. –ú–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (MFA)**

#### **MFAManager:**
```python
import pyotp
import secrets
import qrcode
from typing import List, Tuple

class MFAManager:
    def __init__(self, encryption_manager: EncryptionManager):
        self.encryption_manager = encryption_manager
    
    def generate_secret(self) -> str:
        """–ì–µ–Ω–µ—Ä—É—î TOTP secret"""
        return pyotp.random_base32()
    
    def generate_backup_codes(self, count: int = 10) -> List[str]:
        """–ì–µ–Ω–µ—Ä—É—î backup –∫–æ–¥–∏"""
        codes = []
        for _ in range(count):
            code = secrets.token_hex(4).upper()[:8]  # 8 —Å–∏–º–≤–æ–ª—ñ–≤
            codes.append(code)
        return codes
    
    def verify_totp(self, secret: str, token: str) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä—è—î TOTP —Ç–æ–∫–µ–Ω"""
        totp = pyotp.TOTP(secret)
        return totp.verify(token, valid_window=1)  # 30 —Å–µ–∫ –≤—ñ–∫–Ω–æ
    
    def generate_qr_code(self, secret: str, email: str, issuer: str = "Upwork Web App") -> str:
        """–ì–µ–Ω–µ—Ä—É—î QR –∫–æ–¥ –¥–ª—è Google Authenticator"""
        provisioning_uri = pyotp.totp.TOTP(secret).provisioning_uri(
            email, issuer_name=issuer
        )
        return provisioning_uri
    
    def create_qr_image(self, secret: str, email: str) -> bytes:
        """–°—Ç–≤–æ—Ä—é—î QR –∫–æ–¥ —è–∫ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è"""
        uri = self.generate_qr_code(secret, email)
        qr = qrcode.QRCode(version=1, box_size=10, border=5)
        qr.add_data(uri)
        qr.make(fit=True)
        
        img = qr.make_image(fill_color="black", back_color="white")
        
        # –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –≤ bytes
        import io
        img_bytes = io.BytesIO()
        img.save(img_bytes, format='PNG')
        return img_bytes.getvalue()
    
    def verify_backup_code(self, backup_codes: List[str], code: str) -> Tuple[bool, List[str]]:
        """–ü–µ—Ä–µ–≤—ñ—Ä—è—î backup –∫–æ–¥ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –æ–Ω–æ–≤–ª–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫"""
        if code in backup_codes:
            backup_codes.remove(code)  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∫–æ–¥
            return True, backup_codes
        return False, backup_codes
```

### **4. JWT —Ç–æ–∫–µ–Ω–∏**

#### **JWTManager:**
```python
import jwt
from datetime import datetime, timedelta
from typing import Optional, Dict, Any
import os

class JWTManager:
    def __init__(self):
        self.secret_key = os.getenv('SECRET_KEY')
        if not self.secret_key:
            raise ValueError("SECRET_KEY environment variable is required")
        
        self.algorithm = "HS256"
        self.access_token_expire_minutes = 30
        self.refresh_token_expire_days = 7
    
    def create_access_token(self, data: Dict[str, Any]) -> str:
        """–°—Ç–≤–æ—Ä—é—î access —Ç–æ–∫–µ–Ω"""
        to_encode = data.copy()
        expire = datetime.utcnow() + timedelta(minutes=self.access_token_expire_minutes)
        to_encode.update({
            "exp": expire,
            "type": "access"
        })
        encoded_jwt = jwt.encode(to_encode, self.secret_key, algorithm=self.algorithm)
        return encoded_jwt
    
    def create_refresh_token(self, data: Dict[str, Any]) -> str:
        """–°—Ç–≤–æ—Ä—é—î refresh —Ç–æ–∫–µ–Ω"""
        to_encode = data.copy()
        expire = datetime.utcnow() + timedelta(days=self.refresh_token_expire_days)
        to_encode.update({
            "exp": expire,
            "type": "refresh"
        })
        encoded_jwt = jwt.encode(to_encode, self.secret_key, algorithm=self.algorithm)
        return encoded_jwt
    
    def verify_token(self, token: str) -> Optional[Dict[str, Any]]:
        """–ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω"""
        try:
            payload = jwt.decode(token, self.secret_key, algorithms=[self.algorithm])
            return payload
        except jwt.ExpiredSignatureError:
            return None
        except jwt.JWTError:
            return None
    
    def decode_token(self, token: str) -> Optional[Dict[str, Any]]:
        """–î–µ–∫–æ–¥—É—î —Ç–æ–∫–µ–Ω –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó"""
        try:
            payload = jwt.decode(token, self.secret_key, algorithms=[self.algorithm], options={"verify_exp": False})
            return payload
        except jwt.JWTError:
            return None
```

### **5. Rate Limiting**

#### **RateLimiter:**
```python
import redis
import time
from typing import Optional

class RateLimiter:
    def __init__(self, redis_client: redis.Redis):
        self.redis = redis_client
    
    def check_rate_limit(self, key: str, limit: int, window: int) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä—è—î rate limit"""
        current = self.redis.incr(key)
        if current == 1:
            self.redis.expire(key, window)
        return current <= limit
    
    def get_remaining_attempts(self, key: str) -> int:
        """–ü–æ–≤–µ—Ä—Ç–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ª–∏—à–µ–Ω–∏—Ö —Å–ø—Ä–æ–±"""
        current = self.redis.get(key)
        if current is None:
            return 0
        return int(current)
    
    def reset_rate_limit(self, key: str):
        """–°–∫–∏–¥–∞—î rate limit"""
        self.redis.delete(key)
    
    def check_login_attempts(self, user_id: int) -> Tuple[bool, Optional[int]]:
        """–ü–µ—Ä–µ–≤—ñ—Ä—è—î —Å–ø—Ä–æ–±–∏ –≤—Ö–æ–¥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
        key = f"login_attempts:{user_id}"
        attempts = self.redis.get(key)
        
        if attempts is None:
            return True, None
        
        attempts = int(attempts)
        if attempts >= 5:
            # –ï–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–∞–ª—å–Ω–µ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
            lock_duration = min(2 ** (attempts - 5), 24 * 3600)  # –ú–∞–∫—Å–∏–º—É–º 24 –≥–æ–¥–∏–Ω–∏
            return False, lock_duration
        
        return True, None
    
    def increment_login_attempts(self, user_id: int):
        """–ó–±—ñ–ª—å—à—É—î –ª—ñ—á–∏–ª—å–Ω–∏–∫ –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±"""
        key = f"login_attempts:{user_id}"
        self.redis.incr(key)
        self.redis.expire(key, 3600)  # 1 –≥–æ–¥–∏–Ω–∞
```

### **6. OAuth 2.0 Manager**

#### **OAuth2Manager:**
```python
import aiohttp
import os
from urllib.parse import urlencode
from typing import Dict, Optional

class OAuth2Manager:
    def __init__(self):
        self.client_id = os.getenv('UPWORK_CLIENT_ID')
        self.client_secret = os.getenv('UPWORK_CLIENT_SECRET')
        self.redirect_uri = os.getenv('UPWORK_REDIRECT_URI')
        
        if not all([self.client_id, self.client_secret, self.redirect_uri]):
            raise ValueError("Missing OAuth configuration")
    
    def get_authorization_url(self, state: str) -> str:
        """–ì–µ–Ω–µ—Ä—É—î URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –≤ Upwork"""
        params = {
            'response_type': 'code',
            'client_id': self.client_id,
            'redirect_uri': self.redirect_uri,
            'state': state,
            'scope': 'r_workdiary r_workdairy r_workdairy_read r_workdairy_write'
        }
        return f"https://www.upwork.com/services/api/auth?{urlencode(params)}"
    
    async def exchange_code_for_tokens(self, code: str) -> Dict[str, Any]:
        """–û–±–º—ñ–Ω—é—î –∫–æ–¥ –Ω–∞ —Ç–æ–∫–µ–Ω–∏"""
        data = {
            'grant_type': 'authorization_code',
            'code': code,
            'client_id': self.client_id,
            'client_secret': self.client_secret,
            'redirect_uri': self.redirect_uri
        }
        
        async with aiohttp.ClientSession() as session:
            async with session.post(
                'https://www.upwork.com/api/v2/oauth2/token',
                data=data
            ) as response:
                return await response.json()
    
    async def refresh_access_token(self, refresh_token: str) -> Dict[str, Any]:
        """–û–Ω–æ–≤–ª—é—î access —Ç–æ–∫–µ–Ω"""
        data = {
            'grant_type': 'refresh_token',
            'refresh_token': refresh_token,
            'client_id': self.client_id,
            'client_secret': self.client_secret
        }
        
        async with aiohttp.ClientSession() as session:
            async with session.post(
                'https://www.upwork.com/api/v2/oauth2/token',
                data=data
            ) as response:
                return await response.json()
```

### **7. Security Monitor**

#### **SecurityMonitor:**
```python
from typing import Dict, Any, Optional
import asyncio
from datetime import datetime

class SecurityMonitor:
    def __init__(self, telegram_bot, email_service):
        self.telegram_bot = telegram_bot
        self.email_service = email_service
    
    async def log_security_event(self, user_id: Optional[int], action: str, 
                                ip_address: str, user_agent: str, 
                                success: bool, details: Dict[str, Any] = None):
        """–õ–æ–≥—É—î –ø–æ–¥—ñ—é –±–µ–∑–ø–µ–∫–∏"""
        log_entry = SecurityLog(
            user_id=user_id,
            action=action,
            ip_address=ip_address,
            user_agent=user_agent,
            success=success,
            details=details
        )
        
        # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –ë–î
        # db.add(log_entry)
        # db.commit()
        
        # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
        await self.check_suspicious_activity(user_id, action, ip_address)
    
    async def check_suspicious_activity(self, user_id: Optional[int], 
                                      action: str, ip_address: str):
        """–ü–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞ –ø—ñ–¥–æ–∑—Ä—ñ–ª—É –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å"""
        suspicious_patterns = [
            'multiple_failed_logins',
            'unusual_ip_address',
            'rapid_api_calls',
            'data_access_pattern'
        ]
        
        # –õ–æ–≥—ñ–∫–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
        if action == 'login' and not success:
            await self.check_failed_login_pattern(user_id, ip_address)
        
        if action == 'api_call':
            await self.check_api_usage_pattern(user_id, ip_address)
    
    async def create_security_alert(self, user_id: Optional[int], 
                                  alert_type: str, severity: str, 
                                  description: str, details: Dict[str, Any] = None):
        """–°—Ç–≤–æ—Ä—é—î —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏"""
        alert = SecurityAlert(
            user_id=user_id,
            alert_type=alert_type,
            severity=severity,
            description=description,
            details=details
        )
        
        # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –ë–î
        # db.add(alert)
        # db.commit()
        
        # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
        await self.send_security_notifications(alert)
    
    async def send_security_notifications(self, alert: SecurityAlert):
        """–í—ñ–¥–ø—Ä–∞–≤–ª—è—î —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –±–µ–∑–ø–µ–∫—É"""
        # Telegram —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
        if alert.severity in ['high', 'critical']:
            await self.telegram_bot.send_security_alert(alert)
        
        # Email —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
        if alert.user_id:
            await self.email_service.send_security_alert(alert)
```

### **8. API Endpoints**

#### **Auth Endpoints:**
```python
from fastapi import APIRouter, Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer, OAuth2PasswordRequestForm

router = APIRouter(prefix="/auth", tags=["authentication"])

@router.post("/register")
async def register(user_data: UserCreate):
    """–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
    # –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
    # –•–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    # –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ–π–Ω–æ–≥–æ email
    pass

@router.post("/login")
async def login(form_data: OAuth2PasswordRequestForm = Depends()):
    """–í—Ö—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ credentials
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ MFA
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è JWT —Ç–æ–∫–µ–Ω—ñ–≤
    # –õ–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ—ó
    pass

@router.post("/mfa/verify")
async def verify_mfa(token: str, user_id: int):
    """–í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è MFA"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ TOTP –∞–±–æ backup –∫–æ–¥—É
    # –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    pass

@router.post("/upwork/connect")
async def connect_upwork():
    """–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è Upwork –∞–∫–∞—É–Ω—Ç—É"""
    # –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è OAuth URL
    # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ Upwork
    pass

@router.post("/upwork/callback")
async def upwork_callback(code: str, state: str):
    """OAuth callback –≤—ñ–¥ Upwork"""
    # –û–±–º—ñ–Ω –∫–æ–¥—É –Ω–∞ —Ç–æ–∫–µ–Ω–∏
    # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤
    # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –¥–æ–¥–∞—Ç–æ–∫
    pass

@router.post("/refresh")
async def refresh_token(refresh_token: str):
    """–û–Ω–æ–≤–ª–µ–Ω–Ω—è access —Ç–æ–∫–µ–Ω–∞"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ refresh —Ç–æ–∫–µ–Ω–∞
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ access —Ç–æ–∫–µ–Ω–∞
    pass

@router.post("/logout")
async def logout():
    """–í–∏—Ö—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
    # –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞ –≤ blacklist
    # –û—á–∏—â–µ–Ω–Ω—è —Å–µ—Å—ñ—ó
    pass
```

#### **Security Endpoints:**
```python
@router.get("/security/profile")
async def get_security_profile(user: User = Depends(get_current_user)):
    """–û—Ç—Ä–∏–º—É—î –ø—Ä–æ—Ñ—ñ–ª—å –±–µ–∑–ø–µ–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞"""
    pass

@router.post("/security/mfa/enable")
async def enable_mfa(user: User = Depends(get_current_user)):
    """–£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è MFA"""
    pass

@router.post("/security/mfa/disable")
async def disable_mfa(user: User = Depends(get_current_user)):
    """–í–∏–º–∫–Ω–µ–Ω–Ω—è MFA"""
    pass

@router.post("/security/password")
async def change_password(user: User = Depends(get_current_user)):
    """–ó–º—ñ–Ω–∞ –ø–∞—Ä–æ–ª—è"""
    pass

@router.get("/security/logs")
async def get_security_logs(user: User = Depends(get_current_user)):
    """–û—Ç—Ä–∏–º—É—î –ª–æ–≥–∏ –±–µ–∑–ø–µ–∫–∏"""
        pass
```

### **9. Middleware**

#### **AuthMiddleware:**
```python
from fastapi import Request, HTTPException
from fastapi.responses import JSONResponse
import time

class AuthMiddleware:
    def __init__(self, jwt_manager: JWTManager, rate_limiter: RateLimiter):
        self.jwt_manager = jwt_manager
        self.rate_limiter = rate_limiter
    
    async def __call__(self, request: Request, call_next):
        # –õ–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É
        start_time = time.time()
        
        # Rate limiting
        client_ip = request.client.host
        if not self.rate_limiter.check_rate_limit(f"api:{client_ip}", 100, 3600):
            return JSONResponse(
                status_code=429,
                content={"detail": "Too many requests"}
            )
        
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
        auth_header = request.headers.get("Authorization")
        if auth_header and auth_header.startswith("Bearer "):
            token = auth_header.split(" ")[1]
            payload = self.jwt_manager.verify_token(token)
            
            if payload:
                request.state.user_id = payload.get("user_id")
                request.state.user_role = payload.get("role")
            else:
                return JSONResponse(
                    status_code=401,
                    content={"detail": "Invalid token"}
                )
        
        # –û–±—Ä–æ–±–∫–∞ –∑–∞–ø–∏—Ç—É
        response = await call_next(request)
        
        # –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
        process_time = time.time() - start_time
        response.headers["X-Process-Time"] = str(process_time)
        
        return response
```

### **10. –ú—ñ–≥—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö**

#### **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π:**
```python
# alembic/versions/001_create_security_tables.py

"""Create security tables

Revision ID: 001
Revises: 
Create Date: 2024-12-19 10:00:00.000000

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

def upgrade():
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    op.create_table('users',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('email', sa.String(length=255), nullable=False),
        sa.Column('password_hash', sa.String(length=255), nullable=False),
        sa.Column('first_name', sa.String(length=100), nullable=True),
        sa.Column('last_name', sa.String(length=100), nullable=True),
        sa.Column('upwork_access_token', sa.String(length=1000), nullable=True),
        sa.Column('upwork_refresh_token', sa.String(length=1000), nullable=True),
        sa.Column('upwork_user_id', sa.String(length=255), nullable=True),
        sa.Column('token_expires_at', sa.DateTime(), nullable=True),
        sa.Column('role', sa.String(length=50), nullable=True),
        sa.Column('is_verified', sa.Boolean(), nullable=True),
        sa.Column('is_active', sa.Boolean(), nullable=True),
        sa.Column('email_verified', sa.Boolean(), nullable=True),
        sa.Column('phone_verified', sa.Boolean(), nullable=True),
        sa.Column('last_login', sa.DateTime(), nullable=True),
        sa.Column('failed_login_attempts', sa.Integer(), nullable=True),
        sa.Column('account_locked_until', sa.DateTime(), nullable=True),
        sa.Column('created_at', sa.DateTime(), nullable=True),
        sa.Column('updated_at', sa.DateTime(), nullable=True),
        sa.PrimaryKeyConstraint('id'),
        sa.UniqueConstraint('email')
    )
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –±–µ–∑–ø–µ–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
    op.create_table('user_security',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('user_id', sa.Integer(), nullable=False),
        sa.Column('mfa_enabled', sa.Boolean(), nullable=True),
        sa.Column('mfa_secret', sa.String(length=255), nullable=True),
        sa.Column('backup_codes', postgresql.JSON(astext_type=sa.Text()), nullable=True),
        sa.Column('phone_number', sa.String(length=20), nullable=True),
        sa.Column('phone_verified', sa.Boolean(), nullable=True),
        sa.Column('session_timeout', sa.Integer(), nullable=True),
        sa.Column('max_concurrent_sessions', sa.Integer(), nullable=True),
        sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
        sa.PrimaryKeyConstraint('id')
    )
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ —Ä–æ–ª–µ–π
    op.create_table('roles',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('name', sa.String(length=50), nullable=False),
        sa.Column('description', sa.String(length=255), nullable=True),
        sa.Column('permissions', postgresql.JSON(astext_type=sa.Text()), nullable=False),
        sa.Column('is_active', sa.Boolean(), nullable=True),
        sa.Column('created_at', sa.DateTime(), nullable=True),
        sa.PrimaryKeyConstraint('id'),
        sa.UniqueConstraint('name')
    )
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –ª–æ–≥—ñ–≤ –±–µ–∑–ø–µ–∫–∏
    op.create_table('security_logs',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('user_id', sa.Integer(), nullable=True),
        sa.Column('action', sa.String(length=100), nullable=False),
        sa.Column('ip_address', sa.String(length=45), nullable=True),
        sa.Column('user_agent', sa.String(length=500), nullable=True),
        sa.Column('success', sa.Boolean(), nullable=True),
        sa.Column('details', postgresql.JSON(astext_type=sa.Text()), nullable=True),
        sa.Column('created_at', sa.DateTime(), nullable=True),
        sa.Column('session_id', sa.String(length=255), nullable=True),
        sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
        sa.PrimaryKeyConstraint('id')
    )
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ —Å–ø–æ–≤—ñ—â–µ–Ω—å –±–µ–∑–ø–µ–∫–∏
    op.create_table('security_alerts',
        sa.Column('id', sa.Integer(), nullable=False),
        sa.Column('user_id', sa.Integer(), nullable=True),
        sa.Column('alert_type', sa.String(length=100), nullable=False),
        sa.Column('severity', sa.String(length=20), nullable=False),
        sa.Column('title', sa.String(length=255), nullable=False),
        sa.Column('description', sa.Text(), nullable=True),
        sa.Column('details', postgresql.JSON(astext_type=sa.Text()), nullable=True),
        sa.Column('resolved', sa.Boolean(), nullable=True),
        sa.Column('resolved_by', sa.Integer(), nullable=True),
        sa.Column('resolved_at', sa.DateTime(), nullable=True),
        sa.Column('created_at', sa.DateTime(), nullable=True),
        sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
        sa.PrimaryKeyConstraint('id')
    )

def downgrade():
    op.drop_table('security_alerts')
    op.drop_table('security_logs')
    op.drop_table('roles')
    op.drop_table('user_security')
    op.drop_table('users')
```

---

## üöÄ **–ü–õ–ê–ù –í–ü–†–û–í–ê–î–ñ–ï–ù–ù–Ø**

### **–ï—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞ –±–µ–∑–ø–µ–∫–∞ (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Ç–∞ –≤—Ö—ñ–¥**
   - –í–∞–ª—ñ–¥–∞—Ü—ñ—è email/–ø–∞—Ä–æ–ª—è
   - bcrypt —Ö–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
   - Rate limiting –¥–ª—è –≤—Ö–æ–¥—É
   - –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—ñ—Å–ª—è –Ω–µ–≤–¥–∞–ª–∏—Ö —Å–ø—Ä–æ–±

2. **JWT —Ç–æ–∫–µ–Ω–∏**
   - Access —Ç–∞ refresh —Ç–æ–∫–µ–Ω–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
   - Blacklist –¥–ª—è logout

### **–ï—Ç–∞–ø 2: OAuth 2.0 (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **Upwork —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è**
   - OAuth flow
   - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

2. **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è**
   - –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤ –≤ –ë–î
   - –ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è

### **–ï—Ç–∞–ø 3: –†–æ–∑—à–∏—Ä–µ–Ω–∞ –±–µ–∑–ø–µ–∫–∞ (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **MFA**
   - TOTP (Google Authenticator)
   - SMS –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è
   - Backup –∫–æ–¥–∏

2. **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**
   - –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –¥—ñ–π
   - –°–∏—Å—Ç–µ–º–∞ —Å–ø–æ–≤—ñ—â–µ–Ω—å
   - –ê–Ω–∞–ª—ñ–∑ –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### **–ï—Ç–∞–ø 4: –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—è (1 —Ç–∏–∂–¥–µ–Ω—å)**
1. **–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π**
   - –†—ñ–∑–Ω—ñ —Ä—ñ–≤–Ω—ñ –¥–æ—Å—Ç—É–ø—É
   - –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ –ø–∞–Ω–µ–ª—å

2. **–ê—É–¥–∏—Ç**
   - –î–µ—Ç–∞–ª—å–Ω—ñ –ª–æ–≥–∏
   - –ï–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö
   - –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏

---

## ‚ö†Ô∏è **–í–ê–ñ–õ–ò–í–Ü –ó–ê–£–í–ê–ñ–ï–ù–ù–Ø**

### **–ë–µ–∑–ø–µ–∫–∞:**
- üîê **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤** - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ
- üîê **HTTPS** - –¥–ª—è –≤—Å—ñ—Ö API –≤–∏–∫–ª–∏–∫—ñ–≤
- üîê **–í–∞–ª—ñ–¥–∞—Ü—ñ—è** - –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- üîê **Rate limiting** - –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –∑–ª–æ–≤–∂–∏–≤–∞–Ω—å

### **–õ–µ–≥–∞–ª—å–Ω—ñ—Å—Ç—å:**
- ‚úÖ **Terms of Service** - –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è Upwork ToS
- ‚úÖ **OAuth 2.0** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π flow
- ‚úÖ **User consent** - –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∑–≥–æ–¥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- ‚úÖ **Data privacy** - –¥–æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è GDPR

### **–ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å:**
- üìà **Rate limits** - –∫–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Å–≤–æ—ó –æ–±–º–µ–∂–µ–Ω–Ω—è
- üìà **Database indexing** - —ñ–Ω–¥–µ–∫—Å–∏ –Ω–∞ `user_id`
- üìà **Caching** - –∫–µ—à—É–≤–∞–Ω–Ω—è –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è API –≤–∏–∫–ª–∏–∫—ñ–≤
- üìà **Monitoring** - –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API

---

*–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: 2024-12-19* 